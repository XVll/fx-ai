[2025-05-13 22:14:03,963][__main__][INFO] - Initializing data provider
[2025-05-13 22:14:03,964][data.provider.data_bento.databento_file_provider][INFO] - Scanning for metadata in '/Users/fx/Repositories/FxAIv2/dnb/mlgo'...
[2025-05-13 22:14:03,972][data.provider.data_bento.databento_file_provider][INFO] - Found 6 directories, indexed 183 files
[2025-05-13 22:14:03,972][__main__][INFO] - Setting up simulator
[2025-05-13 22:14:03,973][__main__][INFO] - Loading data for MLGO from 2025-03-27 to 2025-03-27
[2025-05-13 22:14:03,973][__main__][INFO] - Initializing market from 2025-03-27 00:00:00 to 2025-03-27 23:59:59
[2025-05-13 22:14:03,973][__main__][INFO] - Loading data for MLGO from 2025-03-27 00:00:00+00:00 to 2025-03-27 23:59:59.999999+00:00
[2025-05-13 22:14:03,973][__main__][INFO] - Loading bars_1s from provider for MLGO
[2025-05-13 22:14:04,577][data.provider.data_bento.databento_file_provider][INFO] - Loaded 6466 1s bars for MLGO
[2025-05-13 22:14:04,577][__main__][INFO] - Loaded 6466 rows of bars_1s data for MLGO
[2025-05-13 22:14:04,577][__main__][INFO] - Loading bars_1m from provider for MLGO
[2025-05-13 22:14:04,727][data.provider.data_bento.databento_file_provider][INFO] - Loaded 571 1m bars for MLGO
[2025-05-13 22:14:04,727][__main__][INFO] - Loaded 571 rows of bars_1m data for MLGO
[2025-05-13 22:14:04,727][__main__][INFO] - Loading bars_5m from provider for MLGO
[2025-05-13 22:14:04,727][data.provider.data_bento.databento_file_provider][INFO] - No 5m bar files found for MLGO
[2025-05-13 22:14:04,727][data.provider.data_bento.databento_file_provider][INFO] - No direct 5m bars found for MLGO, building from 1m bars
[2025-05-13 22:14:04,734][data.provider.data_bento.databento_file_provider][INFO] - Loaded 571 1m bars for MLGO
[2025-05-13 22:14:04,739][data.provider.data_bento.databento_file_provider][INFO] - Built 159 5m bars from 1m bars for MLGO
[2025-05-13 22:14:04,739][__main__][INFO] - Loaded 159 rows of bars_5m data for MLGO
[2025-05-13 22:14:04,739][__main__][INFO] - Loading bars_1d from provider for MLGO
[2025-05-13 22:14:04,747][data.provider.data_bento.databento_file_provider][INFO] - Loaded 1 1d bars for MLGO
[2025-05-13 22:14:04,747][__main__][INFO] - Loaded 1 rows of bars_1d data for MLGO
[2025-05-13 22:14:04,748][__main__][INFO] - Loading trades from provider for MLGO
[2025-05-13 22:14:07,412][data.provider.data_bento.databento_file_provider][INFO] - Loaded 21111 trades for MLGO
[2025-05-13 22:14:07,412][__main__][INFO] - Loaded 21111 rows of trades data for MLGO
[2025-05-13 22:14:07,412][__main__][INFO] - Loading quotes from provider for MLGO
[2025-05-13 22:14:50,015][data.provider.data_bento.databento_file_provider][INFO] - Loaded 193387 quotes for MLGO
[2025-05-13 22:14:50,018][__main__][INFO] - Loaded 193387 rows of quotes data for MLGO
[2025-05-13 22:14:50,018][__main__][INFO] - Loading status from provider for MLGO
[2025-05-13 22:14:50,193][data.provider.data_bento.databento_file_provider][INFO] - Loaded 6 status records for MLGO
[2025-05-13 22:14:50,193][__main__][INFO] - Loaded 6 rows of status data for MLGO
[2025-05-13 22:14:50,193][__main__][INFO] - Data for MLGO is not a DataFrame type: <class 'dict'>
[2025-05-13 22:14:50,193][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:50,193][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:50,193][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:50,193][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:50,193][__main__][INFO] - Extracting features for MLGO
[2025-05-13 22:14:50,194][__main__][WARNING] - No features extracted for MLGO
[2025-05-13 22:14:50,194][__main__][INFO] - Creating trading environment
[2025-05-13 22:14:50,208][__main__][INFO] - Using device: mps
[2025-05-13 22:14:50,208][__main__][INFO] - Creating multi-branch transformer model
[2025-05-13 22:14:50,256][__main__][INFO] - Setting up PPO trainer
[2025-05-13 22:14:50,930][__main__][INFO] - PPO Trainer initialized on device: mps
[2025-05-13 22:14:50,930][__main__][INFO] - Model: MultiBranchTransformer
[2025-05-13 22:14:50,930][__main__][INFO] - Learning rate: 0.0003
[2025-05-13 22:14:50,930][__main__][INFO] - Starting training for 100 updates
[2025-05-13 22:14:50,930][__main__][INFO] - Starting training for 100 updates
[2025-05-13 22:14:52,653][__main__][INFO] - Update 1/100
[2025-05-13 22:14:52,653][__main__][INFO] - Collecting 8 episodes...
[2025-05-13 22:14:52,655][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:52,655][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:52,655][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:14:53,044][__main__][INFO] - SELL order filled: 90 shares @ $9.9500
[2025-05-13 22:14:53,044][__main__][INFO] - Market order 1000 (sell) filled: 90 shares @ $9.9500
[2025-05-13 22:14:53,045][__main__][INFO] - Reached end of data
[2025-05-13 22:14:53,045][__main__][INFO] - Episode 1 finished: 1 steps, reward: 1791.00, PnL: $1791.00
[2025-05-13 22:14:53,045][__main__][INFO] - Episode finished - PnL: $1791.00 (1.79%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:14:53,078][__main__][INFO] - Episode 1: reward=-0.10, length=1
[2025-05-13 22:14:53,079][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:53,079][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:53,079][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:14:53,096][__main__][INFO] - SELL order filled: 78 shares @ $9.9500
[2025-05-13 22:14:53,097][__main__][INFO] - Market order 1000 (sell) filled: 78 shares @ $9.9500
[2025-05-13 22:14:53,097][__main__][INFO] - Reached end of data
[2025-05-13 22:14:53,097][__main__][INFO] - Episode 2 finished: 1 steps, reward: 1552.20, PnL: $1552.20
[2025-05-13 22:14:53,097][__main__][INFO] - Episode finished - PnL: $1552.20 (1.55%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:14:53,100][__main__][INFO] - Episode 2: reward=-0.10, length=1
[2025-05-13 22:14:53,101][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:53,101][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:53,101][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:14:53,115][__main__][INFO] - BUY order filled: 31 shares @ $10.0500
[2025-05-13 22:14:53,116][__main__][INFO] - Market order 1000 (buy) filled: 31 shares @ $10.0500
[2025-05-13 22:14:53,116][__main__][INFO] - Reached end of data
[2025-05-13 22:14:53,116][__main__][INFO] - Episode 3 finished: 1 steps, reward: 0.00, PnL: $0.00
[2025-05-13 22:14:53,116][__main__][INFO] - Episode finished - PnL: $0.00 (0.00%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:14:53,118][__main__][INFO] - Episode 3: reward=-0.10, length=1
[2025-05-13 22:14:53,119][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:53,119][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:53,120][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:14:53,133][__main__][INFO] - SELL order filled: 81 shares @ $9.9500
[2025-05-13 22:14:53,133][__main__][INFO] - Market order 1000 (sell) filled: 81 shares @ $9.9500
[2025-05-13 22:14:53,133][__main__][INFO] - Reached end of data
[2025-05-13 22:14:53,133][__main__][INFO] - Episode 4 finished: 1 steps, reward: 1611.90, PnL: $1611.90
[2025-05-13 22:14:53,133][__main__][INFO] - Episode finished - PnL: $1611.90 (1.61%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:14:53,136][__main__][INFO] - Episode 4: reward=-0.10, length=1
[2025-05-13 22:14:53,137][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:53,137][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:53,137][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:14:53,150][__main__][INFO] - BUY order filled: 96 shares @ $10.0500
[2025-05-13 22:14:53,150][__main__][INFO] - Market order 1000 (buy) filled: 96 shares @ $10.0500
[2025-05-13 22:14:53,150][__main__][INFO] - Reached end of data
[2025-05-13 22:14:53,150][__main__][INFO] - Episode 5 finished: 1 steps, reward: 0.00, PnL: $0.00
[2025-05-13 22:14:53,150][__main__][INFO] - Episode finished - PnL: $0.00 (0.00%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:14:53,152][__main__][INFO] - Episode 5: reward=-0.10, length=1
[2025-05-13 22:14:53,692][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:53,692][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:53,692][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:14:53,713][__main__][INFO] - BUY order filled: 69 shares @ $10.0500
[2025-05-13 22:14:53,713][__main__][INFO] - Market order 1000 (buy) filled: 69 shares @ $10.0500
[2025-05-13 22:14:53,714][__main__][INFO] - Reached end of data
[2025-05-13 22:14:53,714][__main__][INFO] - Episode 6 finished: 1 steps, reward: 0.00, PnL: $0.00
[2025-05-13 22:14:53,714][__main__][INFO] - Episode finished - PnL: $0.00 (0.00%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:14:53,717][__main__][INFO] - Episode 6: reward=-0.10, length=1
[2025-05-13 22:14:53,718][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:53,718][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:53,718][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:14:53,734][__main__][INFO] - SELL order filled: 5 shares @ $9.9500
[2025-05-13 22:14:53,735][__main__][INFO] - Market order 1000 (sell) filled: 5 shares @ $9.9500
[2025-05-13 22:14:53,735][__main__][INFO] - Reached end of data
[2025-05-13 22:14:53,735][__main__][INFO] - Episode 7 finished: 1 steps, reward: 99.50, PnL: $99.50
[2025-05-13 22:14:53,735][__main__][INFO] - Episode finished - PnL: $99.50 (0.10%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:14:53,738][__main__][INFO] - Episode 7: reward=-0.10, length=1
[2025-05-13 22:14:53,739][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:53,739][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:53,739][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:14:53,755][__main__][INFO] - SELL order filled: 67 shares @ $9.9500
[2025-05-13 22:14:53,755][__main__][INFO] - Market order 1000 (sell) filled: 67 shares @ $9.9500
[2025-05-13 22:14:53,755][__main__][INFO] - Reached end of data
[2025-05-13 22:14:53,755][__main__][INFO] - Episode 8 finished: 1 steps, reward: 1333.30, PnL: $1333.30
[2025-05-13 22:14:53,755][__main__][INFO] - Episode finished - PnL: $1333.30 (1.33%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:14:53,758][__main__][INFO] - Episode 8: reward=-0.10, length=1
[2025-05-13 22:14:53,769][__main__][INFO] - Computing advantages - rewards: torch.Size([8]), values: torch.Size([8, 1]), dones: torch.Size([8])
