[2025-05-13 22:14:52,653][__main__][INFO] - Update 1/100
[2025-05-13 22:14:52,653][__main__][INFO] - Collecting 8 episodes...
[2025-05-13 22:14:52,655][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:52,655][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:52,655][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:14:53,044][__main__][INFO] - SELL order filled: 90 shares @ $9.9500
[2025-05-13 22:14:53,044][__main__][INFO] - Market order 1000 (sell) filled: 90 shares @ $9.9500
[2025-05-13 22:14:53,045][__main__][INFO] - Reached end of data
[2025-05-13 22:14:53,045][__main__][INFO] - Episode 1 finished: 1 steps, reward: 1791.00, PnL: $1791.00
[2025-05-13 22:14:53,045][__main__][INFO] - Episode finished - PnL: $1791.00 (1.79%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:14:53,078][__main__][INFO] - Episode 1: reward=-0.10, length=1
[2025-05-13 22:14:53,079][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:53,079][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:53,079][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:14:53,096][__main__][INFO] - SELL order filled: 78 shares @ $9.9500
[2025-05-13 22:14:53,097][__main__][INFO] - Market order 1000 (sell) filled: 78 shares @ $9.9500
[2025-05-13 22:14:53,097][__main__][INFO] - Reached end of data
[2025-05-13 22:14:53,097][__main__][INFO] - Episode 2 finished: 1 steps, reward: 1552.20, PnL: $1552.20
[2025-05-13 22:14:53,097][__main__][INFO] - Episode finished - PnL: $1552.20 (1.55%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:14:53,100][__main__][INFO] - Episode 2: reward=-0.10, length=1
[2025-05-13 22:14:53,101][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:53,101][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:53,101][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:14:53,115][__main__][INFO] - BUY order filled: 31 shares @ $10.0500
[2025-05-13 22:14:53,116][__main__][INFO] - Market order 1000 (buy) filled: 31 shares @ $10.0500
[2025-05-13 22:14:53,116][__main__][INFO] - Reached end of data
[2025-05-13 22:14:53,116][__main__][INFO] - Episode 3 finished: 1 steps, reward: 0.00, PnL: $0.00
[2025-05-13 22:14:53,116][__main__][INFO] - Episode finished - PnL: $0.00 (0.00%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:14:53,118][__main__][INFO] - Episode 3: reward=-0.10, length=1
[2025-05-13 22:14:53,119][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:53,119][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:53,120][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:14:53,133][__main__][INFO] - SELL order filled: 81 shares @ $9.9500
[2025-05-13 22:14:53,133][__main__][INFO] - Market order 1000 (sell) filled: 81 shares @ $9.9500
[2025-05-13 22:14:53,133][__main__][INFO] - Reached end of data
[2025-05-13 22:14:53,133][__main__][INFO] - Episode 4 finished: 1 steps, reward: 1611.90, PnL: $1611.90
[2025-05-13 22:14:53,133][__main__][INFO] - Episode finished - PnL: $1611.90 (1.61%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:14:53,136][__main__][INFO] - Episode 4: reward=-0.10, length=1
[2025-05-13 22:14:53,137][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:53,137][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:53,137][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:14:53,150][__main__][INFO] - BUY order filled: 96 shares @ $10.0500
[2025-05-13 22:14:53,150][__main__][INFO] - Market order 1000 (buy) filled: 96 shares @ $10.0500
[2025-05-13 22:14:53,150][__main__][INFO] - Reached end of data
[2025-05-13 22:14:53,150][__main__][INFO] - Episode 5 finished: 1 steps, reward: 0.00, PnL: $0.00
[2025-05-13 22:14:53,150][__main__][INFO] - Episode finished - PnL: $0.00 (0.00%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:14:53,152][__main__][INFO] - Episode 5: reward=-0.10, length=1
[2025-05-13 22:14:53,692][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:53,692][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:53,692][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:14:53,713][__main__][INFO] - BUY order filled: 69 shares @ $10.0500
[2025-05-13 22:14:53,713][__main__][INFO] - Market order 1000 (buy) filled: 69 shares @ $10.0500
[2025-05-13 22:14:53,714][__main__][INFO] - Reached end of data
[2025-05-13 22:14:53,714][__main__][INFO] - Episode 6 finished: 1 steps, reward: 0.00, PnL: $0.00
[2025-05-13 22:14:53,714][__main__][INFO] - Episode finished - PnL: $0.00 (0.00%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:14:53,717][__main__][INFO] - Episode 6: reward=-0.10, length=1
[2025-05-13 22:14:53,718][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:53,718][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:53,718][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:14:53,734][__main__][INFO] - SELL order filled: 5 shares @ $9.9500
[2025-05-13 22:14:53,735][__main__][INFO] - Market order 1000 (sell) filled: 5 shares @ $9.9500
[2025-05-13 22:14:53,735][__main__][INFO] - Reached end of data
[2025-05-13 22:14:53,735][__main__][INFO] - Episode 7 finished: 1 steps, reward: 99.50, PnL: $99.50
[2025-05-13 22:14:53,735][__main__][INFO] - Episode finished - PnL: $99.50 (0.10%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:14:53,738][__main__][INFO] - Episode 7: reward=-0.10, length=1
[2025-05-13 22:14:53,739][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:14:53,739][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:14:53,739][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:14:53,755][__main__][INFO] - SELL order filled: 67 shares @ $9.9500
[2025-05-13 22:14:53,755][__main__][INFO] - Market order 1000 (sell) filled: 67 shares @ $9.9500
[2025-05-13 22:14:53,755][__main__][INFO] - Reached end of data
[2025-05-13 22:14:53,755][__main__][INFO] - Episode 8 finished: 1 steps, reward: 1333.30, PnL: $1333.30
[2025-05-13 22:14:53,755][__main__][INFO] - Episode finished - PnL: $1333.30 (1.33%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:14:53,758][__main__][INFO] - Episode 8: reward=-0.10, length=1
[2025-05-13 22:14:53,769][__main__][INFO] - Computing advantages - rewards: torch.Size([8]), values: torch.Size([8, 1]), dones: torch.Size([8])
Error executing job with overrides: ['wandb.enabled=true']
Traceback (most recent call last):
  File "/Users/fx/Repositories/FxAIv2/main.py", line 135, in run_training
    training_stats = trainer.train(cfg.training.total_updates)
  File "/Users/fx/Repositories/FxAIv2/agent/ppo_agent.py", line 497, in train
    update_metrics = self.update_policy()
  File "/Users/fx/Repositories/FxAIv2/agent/ppo_agent.py", line 310, in update_policy
    self.compute_advantages()
  File "/Users/fx/Repositories/FxAIv2/agent/ppo_agent.py", line 276, in compute_advantages
    next_non_terminal = 1.0 - float(dones_np[t, 0])  # Extract scalar value
IndexError: too many indices for array: array is 1-dimensional, but 2 were indexed

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
