[2025-05-13 17:28:26,660][__main__][INFO] - Update 1/100
[2025-05-13 17:28:26,661][__main__][INFO] - Collecting 8 episodes...
[2025-05-13 17:28:26,662][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 17:28:26,675][__main__][INFO] - SELL order filled: 21 shares @ $9.9500
[2025-05-13 17:28:26,675][__main__][INFO] - Market order 1000 (sell) filled: 21 shares @ $9.9500
[2025-05-13 17:28:26,675][__main__][INFO] - Reached end of data
[2025-05-13 17:28:26,675][__main__][INFO] - Episode 1 finished: 1 steps, reward: 417.90, PnL: $417.90
[2025-05-13 17:28:26,676][__main__][INFO] - Episode finished - PnL: $417.90 (0.42%), Win Rate: 0.0%, Trades: 0
[2025-05-13 17:28:26,677][__main__][INFO] - Episode 1: reward=-0.10, length=1
[2025-05-13 17:28:26,678][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 17:28:26,686][__main__][INFO] - BUY order filled: 31 shares @ $10.0500
[2025-05-13 17:28:26,687][__main__][INFO] - Market order 1000 (buy) filled: 31 shares @ $10.0500
[2025-05-13 17:28:26,687][__main__][INFO] - Reached end of data
[2025-05-13 17:28:26,687][__main__][INFO] - Episode 2 finished: 1 steps, reward: 0.00, PnL: $0.00
[2025-05-13 17:28:26,687][__main__][INFO] - Episode finished - PnL: $0.00 (0.00%), Win Rate: 0.0%, Trades: 0
[2025-05-13 17:28:26,688][__main__][INFO] - Episode 2: reward=-0.10, length=1
[2025-05-13 17:28:26,689][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 17:28:26,696][__main__][INFO] - SELL order filled: 56 shares @ $9.9500
[2025-05-13 17:28:26,697][__main__][INFO] - Market order 1000 (sell) filled: 56 shares @ $9.9500
[2025-05-13 17:28:26,697][__main__][INFO] - Reached end of data
[2025-05-13 17:28:26,697][__main__][INFO] - Episode 3 finished: 1 steps, reward: 1114.40, PnL: $1114.40
[2025-05-13 17:28:26,697][__main__][INFO] - Episode finished - PnL: $1114.40 (1.11%), Win Rate: 0.0%, Trades: 0
[2025-05-13 17:28:26,698][__main__][INFO] - Episode 3: reward=-0.10, length=1
[2025-05-13 17:28:26,699][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 17:28:26,707][__main__][INFO] - BUY order filled: 92 shares @ $10.0500
[2025-05-13 17:28:26,707][__main__][INFO] - Market order 1000 (buy) filled: 92 shares @ $10.0500
[2025-05-13 17:28:26,707][__main__][INFO] - Reached end of data
[2025-05-13 17:28:26,707][__main__][INFO] - Episode 4 finished: 1 steps, reward: 0.00, PnL: $0.00
[2025-05-13 17:28:26,708][__main__][INFO] - Episode finished - PnL: $0.00 (0.00%), Win Rate: 0.0%, Trades: 0
[2025-05-13 17:28:26,708][__main__][INFO] - Episode 4: reward=-0.10, length=1
[2025-05-13 17:28:26,709][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 17:28:26,718][__main__][INFO] - BUY order filled: 68 shares @ $10.0500
[2025-05-13 17:28:26,718][__main__][INFO] - Market order 1000 (buy) filled: 68 shares @ $10.0500
[2025-05-13 17:28:26,718][__main__][INFO] - Reached end of data
[2025-05-13 17:28:26,718][__main__][INFO] - Episode 5 finished: 1 steps, reward: 0.00, PnL: $0.00
[2025-05-13 17:28:26,719][__main__][INFO] - Episode finished - PnL: $0.00 (0.00%), Win Rate: 0.0%, Trades: 0
[2025-05-13 17:28:26,719][__main__][INFO] - Episode 5: reward=-0.10, length=1
[2025-05-13 17:28:27,650][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 17:28:27,658][__main__][INFO] - SELL order filled: 76 shares @ $9.9500
[2025-05-13 17:28:27,659][__main__][INFO] - Market order 1000 (sell) filled: 76 shares @ $9.9500
[2025-05-13 17:28:27,659][__main__][INFO] - Reached end of data
[2025-05-13 17:28:27,659][__main__][INFO] - Episode 6 finished: 1 steps, reward: 1512.40, PnL: $1512.40
[2025-05-13 17:28:27,660][__main__][INFO] - Episode finished - PnL: $1512.40 (1.51%), Win Rate: 0.0%, Trades: 0
[2025-05-13 17:28:27,661][__main__][INFO] - Episode 6: reward=-0.10, length=1
[2025-05-13 17:28:27,662][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 17:28:27,672][__main__][INFO] - SELL order filled: 21 shares @ $9.9500
[2025-05-13 17:28:27,673][__main__][INFO] - Market order 1000 (sell) filled: 21 shares @ $9.9500
[2025-05-13 17:28:27,674][__main__][INFO] - Reached end of data
[2025-05-13 17:28:27,674][__main__][INFO] - Episode 7 finished: 1 steps, reward: 417.90, PnL: $417.90
[2025-05-13 17:28:27,674][__main__][INFO] - Episode finished - PnL: $417.90 (0.42%), Win Rate: 0.0%, Trades: 0
[2025-05-13 17:28:27,675][__main__][INFO] - Episode 7: reward=-0.10, length=1
[2025-05-13 17:28:27,677][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 17:28:27,687][__main__][INFO] - BUY order filled: 77 shares @ $10.0500
[2025-05-13 17:28:27,688][__main__][INFO] - Market order 1000 (buy) filled: 77 shares @ $10.0500
[2025-05-13 17:28:27,688][__main__][INFO] - Reached end of data
[2025-05-13 17:28:27,688][__main__][INFO] - Episode 8 finished: 1 steps, reward: 0.00, PnL: $0.00
[2025-05-13 17:28:27,688][__main__][INFO] - Episode finished - PnL: $0.00 (0.00%), Win Rate: 0.0%, Trades: 0
[2025-05-13 17:28:27,690][__main__][INFO] - Episode 8: reward=-0.10, length=1
[2025-05-13 17:28:27,691][__main__][INFO] - Computing advantages - rewards: torch.Size([8, 1]), values: torch.Size([8, 1]), dones: torch.Size([8, 1])
C:\Users\Fx\PycharmProjects\fx-ai\agent\ppo_agent.py:291: DeprecationWarning:

Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)

Error executing job with overrides: ['wandb.enabled=true']
Traceback (most recent call last):
  File "C:\Users\Fx\PycharmProjects\fx-ai\main.py", line 138, in run_training
    training_stats = trainer.train(cfg.training.total_updates)
  File "C:\Users\Fx\PycharmProjects\fx-ai\agent\ppo_agent.py", line 515, in train
    update_metrics = self.update_policy()
  File "C:\Users\Fx\PycharmProjects\fx-ai\agent\ppo_agent.py", line 328, in update_policy
    self.compute_advantages()
  File "C:\Users\Fx\PycharmProjects\fx-ai\agent\ppo_agent.py", line 303, in compute_advantages
    advantages[t, 0] = last_gae
TypeError: can't assign a numpy.float32 to a torch.FloatTensor

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
