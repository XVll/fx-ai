[2025-05-13 22:10:44,770][__main__][INFO] - Update 1/100
[2025-05-13 22:10:44,770][__main__][INFO] - Collecting 8 episodes...
[2025-05-13 22:10:44,772][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:10:44,773][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:10:44,773][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:10:44,824][__main__][INFO] - SELL order filled: 96 shares @ $9.9500
[2025-05-13 22:10:44,824][__main__][INFO] - Market order 1000 (sell) filled: 96 shares @ $9.9500
[2025-05-13 22:10:44,825][__main__][INFO] - Reached end of data
[2025-05-13 22:10:44,825][__main__][INFO] - Episode 1 finished: 1 steps, reward: 1910.40, PnL: $1910.40
[2025-05-13 22:10:44,825][__main__][INFO] - Episode finished - PnL: $1910.40 (1.91%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:10:44,932][__main__][INFO] - Episode 1: reward=-0.10, length=1
[2025-05-13 22:10:44,933][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:10:44,933][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:10:44,933][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:10:44,947][__main__][INFO] - SELL order filled: 51 shares @ $9.9500
[2025-05-13 22:10:44,948][__main__][INFO] - Market order 1000 (sell) filled: 51 shares @ $9.9500
[2025-05-13 22:10:44,948][__main__][INFO] - Reached end of data
[2025-05-13 22:10:44,948][__main__][INFO] - Episode 2 finished: 1 steps, reward: 1014.90, PnL: $1014.90
[2025-05-13 22:10:44,948][__main__][INFO] - Episode finished - PnL: $1014.90 (1.01%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:10:44,950][__main__][INFO] - Episode 2: reward=-0.10, length=1
[2025-05-13 22:10:44,951][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:10:44,951][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:10:44,951][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:10:44,967][__main__][INFO] - SELL order filled: 72 shares @ $9.9500
[2025-05-13 22:10:44,968][__main__][INFO] - Market order 1000 (sell) filled: 72 shares @ $9.9500
[2025-05-13 22:10:44,968][__main__][INFO] - Reached end of data
[2025-05-13 22:10:44,968][__main__][INFO] - Episode 3 finished: 1 steps, reward: 1432.80, PnL: $1432.80
[2025-05-13 22:10:44,968][__main__][INFO] - Episode finished - PnL: $1432.80 (1.43%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:10:44,970][__main__][INFO] - Episode 3: reward=-0.10, length=1
[2025-05-13 22:10:44,971][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:10:44,971][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:10:44,971][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:10:44,985][__main__][INFO] - SELL order filled: 38 shares @ $9.9500
[2025-05-13 22:10:44,985][__main__][INFO] - Market order 1000 (sell) filled: 38 shares @ $9.9500
[2025-05-13 22:10:44,985][__main__][INFO] - Reached end of data
[2025-05-13 22:10:44,985][__main__][INFO] - Episode 4 finished: 1 steps, reward: 756.20, PnL: $756.20
[2025-05-13 22:10:44,985][__main__][INFO] - Episode finished - PnL: $756.20 (0.76%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:10:44,988][__main__][INFO] - Episode 4: reward=-0.10, length=1
[2025-05-13 22:10:44,988][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:10:44,988][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:10:44,989][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:10:45,002][__main__][INFO] - SELL order filled: 96 shares @ $9.9500
[2025-05-13 22:10:45,002][__main__][INFO] - Market order 1000 (sell) filled: 96 shares @ $9.9500
[2025-05-13 22:10:45,002][__main__][INFO] - Reached end of data
[2025-05-13 22:10:45,002][__main__][INFO] - Episode 5 finished: 1 steps, reward: 1910.40, PnL: $1910.40
[2025-05-13 22:10:45,002][__main__][INFO] - Episode finished - PnL: $1910.40 (1.91%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:10:45,004][__main__][INFO] - Episode 5: reward=-0.10, length=1
[2025-05-13 22:10:45,557][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:10:45,557][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:10:45,557][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:10:45,572][__main__][INFO] - BUY order filled: 83 shares @ $10.0500
[2025-05-13 22:10:45,572][__main__][INFO] - Market order 1000 (buy) filled: 83 shares @ $10.0500
[2025-05-13 22:10:45,572][__main__][INFO] - Reached end of data
[2025-05-13 22:10:45,572][__main__][INFO] - Episode 6 finished: 1 steps, reward: 0.00, PnL: $0.00
[2025-05-13 22:10:45,572][__main__][INFO] - Episode finished - PnL: $0.00 (0.00%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:10:45,575][__main__][INFO] - Episode 6: reward=-0.10, length=1
[2025-05-13 22:10:45,576][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:10:45,576][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:10:45,576][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:10:45,589][__main__][INFO] - BUY order filled: 66 shares @ $10.0500
[2025-05-13 22:10:45,589][__main__][INFO] - Market order 1000 (buy) filled: 66 shares @ $10.0500
[2025-05-13 22:10:45,589][__main__][INFO] - Reached end of data
[2025-05-13 22:10:45,589][__main__][INFO] - Episode 7 finished: 1 steps, reward: 0.00, PnL: $0.00
[2025-05-13 22:10:45,589][__main__][INFO] - Episode finished - PnL: $0.00 (0.00%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:10:45,592][__main__][INFO] - Episode 7: reward=-0.10, length=1
[2025-05-13 22:10:45,593][__main__][WARNING] - WARNING: Could not find valid price data, using default values
[2025-05-13 22:10:45,593][__main__][INFO] - Market initialized: Price=$10.0000, Bid=$9.9500, Ask=$10.0500, Spread=$0.1000
[2025-05-13 22:10:45,593][__main__][INFO] - Resetting to timestamp: None
[2025-05-13 22:10:45,608][__main__][INFO] - SELL order filled: 89 shares @ $9.9500
[2025-05-13 22:10:45,608][__main__][INFO] - Market order 1000 (sell) filled: 89 shares @ $9.9500
[2025-05-13 22:10:45,608][__main__][INFO] - Reached end of data
[2025-05-13 22:10:45,608][__main__][INFO] - Episode 8 finished: 1 steps, reward: 1771.10, PnL: $1771.10
[2025-05-13 22:10:45,609][__main__][INFO] - Episode finished - PnL: $1771.10 (1.77%), Win Rate: 0.0%, Trades: 0
[2025-05-13 22:10:45,612][__main__][INFO] - Episode 8: reward=-0.10, length=1
[2025-05-13 22:10:45,624][__main__][INFO] - Computing advantages - rewards: torch.Size([8, 1]), values: torch.Size([8, 1]), dones: torch.Size([8, 1])
/Users/fx/Repositories/FxAIv2/agent/ppo_agent.py:291: DeprecationWarning:

Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)

Error executing job with overrides: ['wandb.enabled=true']
Traceback (most recent call last):
  File "/Users/fx/Repositories/FxAIv2/main.py", line 174, in run_training
    training_stats = trainer.train(cfg.training.total_updates)
  File "/Users/fx/Repositories/FxAIv2/agent/ppo_agent.py", line 515, in train
    update_metrics = self.update_policy()
  File "/Users/fx/Repositories/FxAIv2/agent/ppo_agent.py", line 328, in update_policy
    self.compute_advantages()
  File "/Users/fx/Repositories/FxAIv2/agent/ppo_agent.py", line 303, in compute_advantages
    advantages[t, 0] = last_gae
TypeError: can't assign a numpy.float32 to a torch.FloatTensor

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
